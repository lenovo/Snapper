#-------------------------------------------------------------------------
# Copyright (c) 2018-present, Lenovo. All rights reserved. 
# Licensed under BSD, see COPYING.BSD file for details.
#---------------------------------------------------------------------------

#---------------------------------------------------------------------------
PKGSRC_TGT = rootfs
EXPORT_SUBDIR = odata

#---------------------------------------------------------------------------
lib_LTLIBRARIES = libodata.la
libodata_la_LDFLAGS = -avoid-version


EXPORT_INCS =

#---------------------------------------------------------------------------
ODATA_SUPPRESSIONS = -std=c++11 -fno-strict-aliasing -pedantic \
					-Werror  \
					-Wno-unknown-pragmas \
					-Wno-reorder \
					-Wno-unused-function \
					-Wmissing-format-attribute \
					-Wno-attributes \
					-Wno-char-subscripts \
					-Wno-sign-compare \
					-Wno-parentheses \
					-Wno-unused-variable \
					-Wno-deprecated \
					-Wno-return-type \
					-Wno-format-nonliteral

libodata_la_CPPFLAGS = $(AM_CPPFLAGS) -fPIC -I $(top_srcdir)/snapper/include $(ODATA_SUPPRESSIONS)
libodata_la_SOURCES = \
  common/asyncrt_utils.cpp \
  common/base64.cpp      \
  common/json.cpp      \
  common/json_parsing.cpp      \
  common/json_serialization.cpp      \
  common/utility.cpp      \
  common/uri.cpp      \
  common/uri_builder.cpp      \
  common/uri_parser.cpp      \
  common/xmlhelpers.cpp      \
  core/odata_context_url_parser.cpp      \
  core/odata_entity_model_builder.cpp      \
  core/odata_entity_value.cpp      \
  core/odata_json_operation_payload_parameter_writer.cpp      \
  core/odata_json_operation_url_parameter_writer.cpp      \
  core/odata_json_reader_full.cpp      \
  core/odata_json_reader_minimal.cpp      \
  core/odata_json_writer.cpp      \
  core/odata_primitive_value.cpp      \
  core/odata_property_map.cpp      \
  core/odata_structured_value.cpp      \
  core/odata_path.cpp      \
  core/odata_path_segment.cpp      \
  core/odata_query_node.cpp      \
  core/odata_path_segment_visitor.cpp      \
  core/odata_query_node_visitor.cpp      \
  core/odata_uri.cpp      \
  core/odata_uri_parser.cpp      \
  core/odata_message_writer.cpp      \
  edm/edm_entity_container.cpp      \
  edm/edm_model_reader.cpp      \
  edm/edm_model_writer.cpp      \
  edm/edm_schema.cpp      \
  edm/edm_model.cpp      \
  edm/edm_model_utility.cpp      \
  edm/edm_type.cpp      \
  bson/json.cpp      \
  bson/bsonobj.cpp      \
  bson/base64.cpp      \
  bson/md5.cpp      \
  bson/oid.cpp      \
  bson/nonce.cpp

#  bson/time_support.cpp
#---------------------------------------------------------------------------
install-data-local:
	(find ${PWD} -type f -a \( -name "*.so" -o -name "*.a" -o -name "*.o" \) | xargs ${STRIP} --strip-unneeded )



#---------------------------------------------------------------------------
include $(BMC_RULES)
